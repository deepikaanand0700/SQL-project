# Write a SQL query to display the data types of all columns in the customers table. #

select column_name , data_type from `ecommerce001-435209.Target_analysis.INFORMATION_SCHEMA.COLUMNS` where table_name = "customers"

# Find the time range between which orders were placed #

Select min(order_purchase_timestamp) as strt_time , max(order_purchase_timestamp) as end_time from `Target_analysis.orders`

# Count unique cities and states where orders were placed #

select count(distinct customer_city) as total_city, count(distinct customer_state) as total_state from `Target_analysis.customers`

# Check if the number of orders increased over time #

select count(distinct order_id) as total_order_ , extract(month from order_purchase_timestamp) as month_, extract(year from order_purchase_timestamp) as year_ from `Target_analysis.orders` group by 3 , 2 order by 3 , 2

# Can we see some kind of monthly seasonality in terms of the no. of orders being placed? #

select count(distinct order_id) as total_order_ , extract(month from order_purchase_timestamp) as month_  from `Target_analysis.orders` group by 2 order by 1 desc

## During what time of the day, do the Brazilian customers mostly place their orders? (Dawn, Morning, Afternoon or Night) 
-- 0-6 hrs : Dawn -- 7-12 hrs : Mornings -- 13-18 hrs : Afternoon -- 19-23 hrs : Night

With hour_category as 
(select order_id, 
case 
when extract(hour from order_purchase_timestamp) between 0 and 6 then "Dawn"
when extract(hour from order_purchase_timestamp) between 7 and 12 then "Mornings"
when extract(hour from order_purchase_timestamp) between 13 and 18 then "Afternoon"
when extract(hour from order_purchase_timestamp) between 19 and 23 then "Night"
End as hours_
 from `Target_analysis.orders`)

 select hours_ , count(order_id) as count_of_order
 from hour_category
 group by hours_
 order by count_of_order desc


